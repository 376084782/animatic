(function(){function t(t){this.stylesheet=document.styleSheets[0],this.animations=t,this.total=this.animations.map(function(t){return t.delay+t.duration}).reduce(function(t,i){return t+i})}function i(){this.handlers={}}function n(t,n,e,a,r){i.call(this),this.item=t,this.translate=n.translate,this.rotate=n.rotate,this.scale=n.scale,this.start=null,this.duration=e||n.duration||500,this.delay=r||n.delay||0,this.ease=o[a]||o[n.ease]||o.linear,this.easeName=a||"linear"}function e(t,e,a,r,s){i.call(this),this.item=t,this.animations=e.map(function(i){return new n(t,i.transform||{translate:i.translate,rotate:i.rotate,scale:i.scale},i.duration||a,i.ease||r,i.delay||s)}),this.start=null,this.delay=0,this.duration=Math.max.apply(null,this.animations.map(function(t){return t.duration+t.delay}))}function a(t){this.items=[],this._nextTick=null,t&&this.init()}function r(t){i.call(this),this.dom=t,this.animations=[],this.state={},this.transform={},this._dirty=!1,this.init()}var s=window.anima={};s.js=function(){return new a(!0)},s.css=function(){return new a},!function(){for(var t=["webkit","Moz","O","ms"],i=0;!window.requestAnimationFrame&&t.length>i;){var n=t[i++].toLowerCase();window.requestAnimationFrame=window[n+"RequestAnimationFrame"],window.cancelAnimationFrame=window[n+"CancelAnimationFrame"]||window[n+"CancelRequestAnimationFrame"]}window.transformProperty=function(){var i=document.createElement("div").style;return i.transform===void 0?t.filter(function(t){return i[t+"Transform"]!==void 0})[0]+"Transform":"transform"}()}();var o=function(){var t={quad:function(t){return Math.pow(t,2)},cubic:function(t){return Math.pow(t,3)},quart:function(t){return Math.pow(t,4)},quint:function(t){return Math.pow(t,5)},expo:function(t){return Math.pow(t,6)},sine:function(t){return 1-Math.cos(t*Math.PI/2)},circ:function(t){return 1-Math.sqrt(1-t*t)},back:function(t){return t*t*(3*t-2)}},i={linear:function(t){return t}};return Object.keys(t).forEach(function(n){var e=t[n];i["ease-in-"+n]=e,i["ease-out-"+n]=function(t){return 1-e(1-t)},i["ease-in-out-"+n]=function(t){return.5>t?e(2*t)/2:1-e(-2*t+2)/2}}),i.css={linear:"cubic-bezier(0.000, 0.000, 1.000, 1.000)","ease-in-quad":"cubic-bezier(0.550, 0.085, 0.680, 0.530)","ease-in-cubic":"cubic-bezier(0.550, 0.055, 0.675, 0.190)","ease-in-quart":"cubic-bezier(0.895, 0.030, 0.685, 0.220)","ease-in-quint":"cubic-bezier(0.755, 0.050, 0.855, 0.060)","ease-in-sine":"cubic-bezier(0.470, 0.000, 0.745, 0.715)","ease-in-expo":"cubic-bezier(0.950, 0.050, 0.795, 0.035)","ease-in-circ":"cubic-bezier(0.600, 0.040, 0.980, 0.335)","ease-in-back":"cubic-bezier(0.600, -0.280, 0.735, 0.045)","ease-out-quad":"cubic-bezier(0.250, 0.460, 0.450, 0.940)","ease-out-cubic":"cubic-bezier(0.215, 0.610, 0.355, 1.000)","ease-out-quart":"cubic-bezier(0.165, 0.840, 0.440, 1.000)","ease-out-quint":"cubic-bezier(0.230, 1.000, 0.320, 1.000)","ease-out-sine":"cubic-bezier(0.390, 0.575, 0.565, 1.000)","ease-out-expo":"cubic-bezier(0.190, 1.000, 0.220, 1.000)","ease-out-circ":"cubic-bezier(0.075, 0.820, 0.165, 1.000)","ease-out-back":"cubic-bezier(0.175, 0.885, 0.320, 1.275)","ease-out-quad":"cubic-bezier(0.455, 0.030, 0.515, 0.955)","ease-out-cubic":"cubic-bezier(0.645, 0.045, 0.355, 1.000)","ease-in-out-quart":"cubic-bezier(0.770, 0.000, 0.175, 1.000)","ease-in-out-quint":"cubic-bezier(0.860, 0.000, 0.070, 1.000)","ease-in-out-sine":"cubic-bezier(0.445, 0.050, 0.550, 0.950)","ease-in-out-expo":"cubic-bezier(1.000, 0.000, 0.000, 1.000)","ease-in-out-circ":"cubic-bezier(0.785, 0.135, 0.150, 0.860)","ease-in-out-back":"cubic-bezier(0.680, -0.550, 0.265, 1.550)"},i}();t.prototype.percent=function(t){return(100*t/this.total).toFixed(3)},t.prototype.toString=function(){for(var t="a"+(Date.now()+Math.floor(100*Math.random())),i=0,e=["@-webkit-keyframes "+t+"{"],a=0,r=this.animations.length;r>a;a++){var s=this.animations[a],u=this.animations[a+1];if(s.init(),s instanceof n)0===a&&e.push("0% {","-webkit-animation-timing-function:"+o.css[s.easeName]+";","}"),s.delay&&e.push(this.percent(i+=s.delay)+"% {","-webkit-transform:"+s.item.matrix()+";","}"),s.transform(1),e.push(this.percent(i+=s.duration)+"% {","-webkit-transform:"+s.item.matrix()+";",u.easeName&&"-webkit-animation-timing-function:"+o.css[u.easeName]+";","}");else{var c=[];s.animations.forEach(function(t){t.delay&&-1===c.indexOf(t.delay)&&c.push(t.delay),t.duration&&-1===c.indexOf(t.delay+t.duration)&&c.push(t.delay+t.duration)});for(var h=0,l=c.length;l>h;++h){for(var f=c[h],p=0,m=s.animations.length;m>p;++p){var d=s.animations[p];d.delay>=f||f>d.delay+d.duration||d.transform((f-d.delay)/d.duration)}e.push(this.percent(i+=f)+"% {","-webkit-transform:"+s.item.matrix()+";","}")}}}e.push("}"),this.stylesheet.insertRule(e.join("")),s.item.dom.style.WebkitAnimation=t+" "+this.total+"ms forwards"},i.prototype.on=function(t,i){return(this.handlers[t]=this.handlers[t]||[]).push(i),this},i.prototype.off=function(t,i){var n=this.handlers[t];return i?n.splice(n.indexOf(i),1):n=[],this},i.prototype.emit=function(t){var i=Array.prototype.slice.call(arguments,1),n=this.handlers[t];if(n)for(var e=n.length,a=0;e>a;++a)n[a].apply(this,i);return this},n.prototype=new i,n.prototype.constructor=n,n.prototype.init=function(t){if(null===this.start){this.start=t;var i=this.item.state;this.initial={translate:i.translate.slice(),rotate:i.rotate.slice(),scale:i.scale.slice()},this.emit("start")}},n.prototype.animate=function(){return this.item.animate.apply(this.item,arguments)},n.prototype.toCSS=function(){return this.item.toCSS()},n.prototype.run=function(t){if(!(t-this.start<this.delay)){var i=(t-this.delay-this.start)/this.duration;0>i&&(i=0),i=this.ease(i),this.transform(i)}},n.prototype.set=function(t,i,n,e){this[t]&&this[t].length&&(this[t][0]&&(i[t][0]=n[t][0]+this[t][0]*e),this[t][1]&&(i[t][1]=n[t][1]+this[t][1]*e),this[t][2]&&(i[t][2]=n[t][2]+this[t][2]*e))},n.prototype.transform=function(t){var i=this.item.state,n=this.initial;this.set("translate",i,n,t),this.set("rotate",i,n,t),this.set("scale",i,n,t)},n.prototype.end=function(t){!t&&this.transform(1),this.emit("end")},e.prototype=new i,e.prototype.constructor=e,e.prototype.init=function(t){if(null===this.start){this.start=t;for(var i=0,n=this.animations.length;n>i;++i)this.animations[i].init(t);this.emit("start")}},e.prototype.animate=function(){return this.item.animate.apply(this.item,arguments)},e.prototype.toCSS=function(){return this.item.toCSS()},e.prototype.run=function(t){for(var i=0;this.animations.length>i;++i){var n=this.animations[i];t>=n.start+n.delay+n.duration?(this.animations.splice(i--,1),n.end()):n.run(t)}},e.prototype.end=function(t){for(var i=0,n=this.animations.length;n>i;++i)this.animations[i].end(t);this.emit("end")},a.prototype.init=function(){function t(n){i.update(n),i._nextTick=requestAnimationFrame(t)}var i=this;this._nextTick=requestAnimationFrame(t)},a.prototype.stop=function(){this._nextTick&&cancelAnimationFrame(this._nextTick)},a.prototype.add=function(t){var i=new r(t);return this.items.push(i),i},a.prototype.update=function(t){for(var i=0,n=this.items.length;n>i;i++)this.items[i].update(t)},a.prototype.on=function(t,i){window.addEventListener(t,i,!0)};var u=Math.PI/180,c={id:function(){return[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1]},multiply:function h(t,i){var n=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1];return n[0]=t[0]*i[0]+t[1]*i[4]+t[2]*i[8],n[1]=t[0]*i[1]+t[1]*i[5]+t[2]*i[9],n[2]=t[0]*i[2]+t[1]*i[6]+t[2]*i[10],n[4]=t[4]*i[0]+t[5]*i[4]+t[6]*i[8],n[5]=t[4]*i[1]+t[5]*i[5]+t[6]*i[9],n[6]=t[4]*i[2]+t[5]*i[6]+t[6]*i[10],n[8]=t[8]*i[0]+t[9]*i[4]+t[10]*i[8],n[9]=t[8]*i[1]+t[9]*i[5]+t[10]*i[9],n[10]=t[8]*i[2]+t[9]*i[6]+t[10]*i[10],n[12]=t[12]*i[0]+t[13]*i[4]+t[14]*i[8]+i[12],n[13]=t[12]*i[1]+t[13]*i[5]+t[14]*i[9]+i[13],n[14]=t[12]*i[2]+t[13]*i[6]+t[14]*i[10]+i[14],2>=arguments.length?n:h.apply(null,[n].concat(Array.prototype.slice.call(arguments,2)))},translate:function(t,i,n){return t||i||n?(t||(t=0),i||(i=0),n||(n=0),[1,0,0,0,0,1,0,0,0,0,1,0,t,i,n,1]):c.id()},translateX:function(t){return this.translate(t,0,0)},translateY:function(t){return this.translate(0,t,0)},translateZ:function(t){return this.translate(0,0,t)},scale:function(t,i,n){return t||i||n?(t||(t=1),i||(i=1),n||(n=1),[t,0,0,0,0,i,0,0,0,0,n,0,0,0,0,1]):c.id()},scaleX:function(t){return this.scale(t,0,0)},scaleY:function(t){return this.scale(0,t,0)},scaleZ:function(t){return this.scale(0,0,t)},rotate:function(t,i,n){if(!(t||i||n))return c.id();t||(t=0),i||(i=0),n||(n=0),t*=u,i*=u,n*=u;var e=Math.sin(t),a=Math.cos(t),r=Math.sin(i),s=Math.cos(i),o=Math.sin(n),h=Math.cos(n);return[s*h,a*o+e*r*h,e*o-a*r*h,0,-s*o,a*h-e*r*o,e*h+a*r*o,0,r,-e*s,a*s,0,0,0,0,1]},rotateX:function(t){t*=u;var i=Math.sin(t),n=Math.cos(t);return[1,0,0,0,0,n,i,0,0,-i,n,0,0,0,0,1]},rotateY:function(t){t*=u;var i=Math.sin(t),n=Math.cos(t);return[n,0,-i,0,0,1,0,0,i,0,n,0,0,0,0,1]},rotateZ:function(t){t*=u;var i=Math.sin(t),n=Math.cos(t);return[n,i,0,0,-i,n,0,0,0,0,1,0,0,0,0,1]},rotate3d:function(t,i,n,e){e*=u;var a=Math.sin(e),r=Math.cos(e),s=Math.sqrt(t*t+i*i+n*n);0===s?(t=0,i=0,n=1):1!==s&&(t/=s,i/=s,n/=s);var o=t*t,c=i*i,h=n*n,l=1-r;return[o+(1-o)*r,t*i*l+n*a,t*n*l-i*a,0,t*i*l-n*a,c+(1-c)*r,i*n*l+t*a,0,t*n*l+i*a,i*n*l-t*a,h+(1-h)*r,0,0,0,0,1]},skew:function(t,i){return t*=u,i*=u,[1,Math.tan(i),0,0,Math.tan(t),1,0,0,0,0,1,0,0,0,0,1]},skewX:function(t){return this.skew(t,0)},skewY:function(t){return this.skew(0,t)},perspective:function(t){return t=-1/t,[1,0,0,0,0,1,0,0,0,0,1,t,0,0,0,1]},toString:function(t){for(var i=0,n=t.length;n>i;++i)1e-6>Math.abs(t[i])&&(t[i]=0);return"matrix3d("+t.join()+")"},toTestString:function(t){function i(t){return t.toFixed(6)}function n(t){return 0===t[2]&&0===t[3]&&0===t[6]&&0===t[7]&&0===t[8]&&0===t[9]&&1===t[10]&&0===t[11]&&0===t[14]&&1===t[15]}function e(t,i){return-1!==[0,1,4,5,12,13].indexOf(i)}return n(t)?"matrix("+t.filter(e).map(i).join(", ")+")":"matrix3d("+t.map(i).join(", ")+")"}};r.prototype=new i,r.prototype.constructor=r,r.prototype.init=function(){this.state={translate:[0,0,0],rotate:[0,0,0],scale:[1,1,1]},this.zero("transform"),this.on("transform",function(t,i,n){this.transform.translate=t,this.transform.rotate=i,this.transform.scale=n,this._dirty=!0})},r.prototype.update=function(t){this.animation(t),this.style()},r.prototype.style=function(){this.dom.style[transformProperty]=this.matrix()},r.prototype.matrix=function(){var t=this.state;return c.toString(c.multiply(c.translate.apply(null,t.translate),c.rotate.apply(null,t.rotate),c.scale.apply(null,t.scale)))},r.prototype.add=function(t,i){this.state[t][0]+=i[0],this.state[t][1]+=i[1],this.state[t][2]+=i[2]},r.prototype.translate=function(t){this.add("translate",t)},r.prototype.rotate=function(t){this.add("rotate",t)},r.prototype.scale=function(t){this.add("scale",t)},r.prototype.clear=function(){this.zero("state")},r.prototype.animate=function(t,i,a,r){var s=Array.isArray(t)?e:n,o=new s(this,t,i,a,r);return this.animations.push(o),this.zero("transform"),o},r.prototype.animation=function(t){if(0===this.animations.length&&this._dirty&&(this.animate(this.transform),this._dirty=!1),0!==this.animations.length)for(;0!==this.animations.length;){var i=this.animations[0];i.init(t);{if(!(t>=i.start+i.delay+i.duration)){i.run(t);break}this.animations.shift(),i.end()}}},r.prototype.zero=function(t){this[t].translate=[0,0,0],this[t].rotate=[0,0,0],this[t].scale=[0,0,0]},r.prototype.reset=function(){if(0!==this.animations.length){for(var t=0,i=this.animations.length;i>t;t++){var n=this.animations[t];n.end(!0)}this.animations=[],this.zero("transform")}},r.prototype.toCSS=function(){return""+new t(this.animations)}})();
//@ sourceMappingURL=anima.min.js.map